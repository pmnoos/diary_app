{% extends 'base.html' %}

{% block title %}Reminders Dashboard - Diary App{% endblock %}

{% block page_title %}📅 Reminders Dashboard{% endblock %}

{% block content %}
    <div style="margin-bottom: 20px; display: flex; gap: 10px; flex-wrap: wrap;">
        <a href="{% url 'reminder_create' %}" class="btn" style="background-color: #28a745;">➕ Add New Reminder</a>
        <a href="{% url 'reminder_list' %}" class="btn" style="background-color: #007bff;">📋 View All Reminders</a>
    </div>

    <!-- Today's Reminders -->
    {% if today_reminders %}
        <div style="background-color: #fff3cd; border: 1px solid #ffc107; padding: 15px; margin-bottom: 20px; border-radius: 5px;">
            <h3 style="color: #856404; margin-top: 0;">🔔 Today's Reminders</h3>
            {% for reminder in today_reminders %}
                <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid #f0f0f0;">
                    <div>
                        <strong>{{ reminder.title }}</strong>
                        {% if reminder.time %} at {{ reminder.time|time:"g:i A" }}{% endif %}
                        <span style="background-color: {{ reminder.priority|yesno:'#dc3545,#ffc107,#28a745,#6c757d' }}; color: white; padding: 2px 6px; border-radius: 3px; font-size: 0.8em; margin-left: 8px;">
                            {{ reminder.get_priority_display }}
                        </span>
                    </div>
                    <div>
                        <a href="{% url 'reminder_detail' reminder.pk %}" style="color: #007bff; text-decoration: none; margin-right: 10px;">View</a>
                        <a href="{% url 'reminder_toggle' reminder.pk %}" style="color: #28a745; text-decoration: none;">✓ Done</a>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% endif %}

    <!-- Overdue Reminders -->
    {% if overdue_reminders %}
        <div style="background-color: #f8d7da; border: 1px solid #dc3545; padding: 15px; margin-bottom: 20px; border-radius: 5px;">
            <h3 style="color: #721c24; margin-top: 0;">⚠️ Overdue Reminders</h3>
            {% for reminder in overdue_reminders %}
                <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid #f0f0f0;">
                    <div>
                        <strong>{{ reminder.title }}</strong>
                        <span style="color: #721c24; font-size: 0.9em;">({{ reminder.date|date:"M j, Y" }})</span>
                        <span style="background-color: #dc3545; color: white; padding: 2px 6px; border-radius: 3px; font-size: 0.8em; margin-left: 8px;">
                            {{ reminder.get_priority_display }}
                        </span>
                    </div>
                    <div>
                        <a href="{% url 'reminder_detail' reminder.pk %}" style="color: #007bff; text-decoration: none; margin-right: 10px;">View</a>
                        <a href="{% url 'reminder_toggle' reminder.pk %}" style="color: #28a745; text-decoration: none;">✓ Done</a>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% endif %}

    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px;">
        
        <!-- Upcoming This Week -->
        <div style="background-color: #d1ecf1; border: 1px solid #17a2b8; padding: 15px; border-radius: 5px;">
            <h3 style="color: #0c5460; margin-top: 0;">📈 Coming This Week</h3>
            {% if upcoming_reminders %}
                {% for reminder in upcoming_reminders %}
                    <div style="padding: 5px 0; border-bottom: 1px solid rgba(0,0,0,0.1);">
                        <strong>{{ reminder.title }}</strong><br>
                        <small style="color: #0c5460;">
                            {{ reminder.date|date:"l, M j" }}
                            {% if reminder.time %} at {{ reminder.time|time:"g:i A" }}{% endif %}
                        </small>
                    </div>
                {% endfor %}
                <div style="margin-top: 10px;">
                    <a href="{% url 'reminder_list' %}?filter=this_week" style="color: #0c5460;">View all this week →</a>
                </div>
            {% else %}
                <p style="color: #0c5460; margin: 0;">No reminders this week! 🎉</p>
            {% endif %}
        </div>

        <!-- Recently Completed -->
        <div style="background-color: #d4edda; border: 1px solid #28a745; padding: 15px; border-radius: 5px;">
            <h3 style="color: #155724; margin-top: 0;">✅ Recently Completed</h3>
            {% if recent_completed %}
                {% for reminder in recent_completed %}
                    <div style="padding: 5px 0; border-bottom: 1px solid rgba(0,0,0,0.1);">
                        <strong>{{ reminder.title }}</strong><br>
                        <small style="color: #155724;">
                            Completed {{ reminder.completed_at|timesince }} ago
                        </small>
                    </div>
                {% endfor %}
                <div style="margin-top: 10px;">
                    <a href="{% url 'reminder_list' %}?filter=completed" style="color: #155724;">View all completed →</a>
                </div>
            {% else %}
                <p style="color: #155724; margin: 0;">No completed reminders yet.</p>
            {% endif %}
        </div>
    </div>

    <!-- Quick Actions -->
    <div style="margin-top: 30px; text-align: center; padding: 20px; background-color: #f8f9fa; border-radius: 5px;">
        <h4>Quick Actions</h4>
        <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
            <a href="{% url 'reminder_list' %}?filter=today" class="btn btn-warning">Today's Tasks</a>
            <a href="{% url 'reminder_list' %}?filter=this_week" class="btn btn-info">This Week</a>
            <a href="{% url 'reminder_list' %}?filter=overdue" class="btn btn-danger">Overdue</a>
            <a href="{% url 'entry_create' %}" class="btn btn-secondary">📝 Write Diary Entry</a>
        </div>
    </div>
{% endblock %}

{% block extra_css %}
    <!-- All button styles now in components.css for better performance -->
{% endblock %}
